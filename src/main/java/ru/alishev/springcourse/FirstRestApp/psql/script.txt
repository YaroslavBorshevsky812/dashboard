create table WorkoutDay (
        id int primary key generated by default as identity,
        date varchar(100) not null,
        title varchar(100)
);

create table WorkoutItem (
     id int primary key generated by default as identity,
     training_day_id int references WorkoutDay(id) on delete set null,
     workout_name varchar(100)
);

create table RepetitionEntity (
      id int primary key generated by default as identity,
      workout_item_id int references WorkoutItem(id) on delete set null,
      number_of_set varchar(100),
      weight int,
      repetitions_number int
)

// Проверить, что заполняются именно все поля.
// Иначе придётся переделывать.
insert into workoutday(date, title) values('06.05.23', 'Зал');
insert into workoutitem(workout_name, training_day_id) values('Жим лёжа', 1);

insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 1, 60, 20);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 2, 80, 15);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 3, 100, 10);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 4, 120, 5);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 5, 130, 6);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 7, 140, 2);
insert into repetitionitem(workout_item_id, number_of_set, weight, repetitions_number) VALUES (7, 8, 130, 5);

\\ двойной join
select * from workoutday join workoutitem w on workoutday.id = w.training_day_id join repetitionitem r on w.id = r.workout_item_id where workoutday.id = 33;

\\ Максимальный вес
select max(weight) as max_weight from workoutday join workoutitem w on workoutday.id = w.training_day_id
join repetitionitem r on w.id = r.workout_item_id where workoutday.id = 33 and workout_name = 'Жим лёжа';

\\ Тонаж
select sum(weight * repetitions_number) from workoutday join workoutitem w on workoutday.id = w.training_day_id
join repetitionitem r on w.id = r.workout_item_id where workout_name = 'Жим лёжа' and workoutday.id = 92;

\\ Тонаж готовый.
select date, workout_name, sum(weight * repetitions_number) as total_weight
from workoutday join workoutitem w on workoutday.id = w.training_day_id
join repetitionitem r on w.id = r.workout_item_id
group by date, workout_name;

\\ Максимальный готовый.
select date, workout_name, max(weight) as max_weight
from workoutday join workoutitem w on workoutday.id = w.training_day_id
join repetitionitem r on w.id = r.workout_item_id
group by date, workout_name;


\\ Пользователи

create table Person (
        id int primary key generated by default as identity,
        name varchar(100),
        lastName varchar(100),
        email varchar(100),
        login varchar(100) not null,
        password varchar(100) not null
)

create table authority(
    id int primary key generated by default as identity,
    authority varchar(255),
    person_id int references person(id) on delete set null
)